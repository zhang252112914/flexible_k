2024-11-09 06:44:35,821:INFO: Effective parameters:
2024-11-09 06:44:35,821:INFO:   <<< K: 16
2024-11-09 06:44:35,821:INFO:   <<< adaptive_cls: 0
2024-11-09 06:44:35,821:INFO:   <<< aggregation: None
2024-11-09 06:44:35,821:INFO:   <<< alpha: 1.0
2024-11-09 06:44:35,821:INFO:   <<< batch_size: 16
2024-11-09 06:44:35,821:INFO:   <<< batch_size_val: 16
2024-11-09 06:44:35,821:INFO:   <<< cache_dir: 
2024-11-09 06:44:35,821:INFO:   <<< cluser_embed_from_clip: 1
2024-11-09 06:44:35,821:INFO:   <<< cluster_algo: kmediods++
2024-11-09 06:44:35,821:INFO:   <<< cluster_distance: euclidean
2024-11-09 06:44:35,821:INFO:   <<< cluster_embedding: 0
2024-11-09 06:44:35,821:INFO:   <<< cluster_frame_embedding: 0
2024-11-09 06:44:35,821:INFO:   <<< cluster_iter_limit: 100
2024-11-09 06:44:35,821:INFO:   <<< cluster_threshold: 1e-05
2024-11-09 06:44:35,821:INFO:   <<< coef_lr: 0.0001
2024-11-09 06:44:35,821:INFO:   <<< cross_model: cross-base
2024-11-09 06:44:35,822:INFO:   <<< cross_num_hidden_layers: 4
2024-11-09 06:44:35,822:INFO:   <<< data_path: /home/zyl/MeVTR_data_and_models/charades/annotation
2024-11-09 06:44:35,822:INFO:   <<< datatype: charades
2024-11-09 06:44:35,822:INFO:   <<< do_eval: False
2024-11-09 06:44:35,822:INFO:   <<< do_lower_case: False
2024-11-09 06:44:35,822:INFO:   <<< do_pretrain: False
2024-11-09 06:44:35,822:INFO:   <<< do_train: True
2024-11-09 06:44:35,822:INFO:   <<< dynamic_alpha: False
2024-11-09 06:44:35,822:INFO:   <<< epochs: 6
2024-11-09 06:44:35,822:INFO:   <<< eval_frame_order: 0
2024-11-09 06:44:35,822:INFO:   <<< expand_msrvtt_sentences: False
2024-11-09 06:44:35,822:INFO:   <<< feature_framerate: 1
2024-11-09 06:44:35,822:INFO:   <<< features_path: /home/zyl/MeVTR_data_and_models/charades/Charades_v2_3
2024-11-09 06:44:35,822:INFO:   <<< fp16: False
2024-11-09 06:44:35,822:INFO:   <<< fp16_opt_level: O1
2024-11-09 06:44:35,822:INFO:   <<< freeze_layer_num: 0
2024-11-09 06:44:35,822:INFO:   <<< global_info: False
2024-11-09 06:44:35,822:INFO:   <<< gradient_accumulation_steps: 1
2024-11-09 06:44:35,822:INFO:   <<< hard_negative_rate: 0.5
2024-11-09 06:44:35,822:INFO:   <<< init_model: None
2024-11-09 06:44:35,822:INFO:   <<< linear_patch: 2d
2024-11-09 06:44:35,822:INFO:   <<< local_rank: 0
2024-11-09 06:44:35,822:INFO:   <<< loose_type: True
2024-11-09 06:44:35,822:INFO:   <<< loss: balanced
2024-11-09 06:44:35,822:INFO:   <<< lr: 0.0001
2024-11-09 06:44:35,822:INFO:   <<< lr_decay: 0.9
2024-11-09 06:44:35,822:INFO:   <<< margin: 0.1
2024-11-09 06:44:35,822:INFO:   <<< max_frames: 64
2024-11-09 06:44:35,823:INFO:   <<< max_words: 77
2024-11-09 06:44:35,823:INFO:   <<< minkowski_norm_p: 2.0
2024-11-09 06:44:35,823:INFO:   <<< n_display: 100
2024-11-09 06:44:35,823:INFO:   <<< n_gpu: 1
2024-11-09 06:44:35,823:INFO:   <<< n_pair: 1
2024-11-09 06:44:35,823:INFO:   <<< negative_weighting: 1
2024-11-09 06:44:35,823:INFO:   <<< num_thread_reader: 2
2024-11-09 06:44:35,823:INFO:   <<< output_dir: /home/zyl/flexible_k/output_debug
2024-11-09 06:44:35,823:INFO:   <<< post_cluster_centroids: 16
2024-11-09 06:44:35,823:INFO:   <<< post_process: topk
2024-11-09 06:44:35,823:INFO:   <<< pre_norm: 0
2024-11-09 06:44:35,823:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-09 06:44:35,823:INFO:   <<< rank: 0
2024-11-09 06:44:35,823:INFO:   <<< regularize: none
2024-11-09 06:44:35,823:INFO:   <<< resume_model: None
2024-11-09 06:44:35,823:INFO:   <<< sampled_use_mil: False
2024-11-09 06:44:35,823:INFO:   <<< save_feature_path: None
2024-11-09 06:44:35,823:INFO:   <<< seed: 42
2024-11-09 06:44:35,823:INFO:   <<< shuffle_events: False
2024-11-09 06:44:35,823:INFO:   <<< shuffle_exp: False
2024-11-09 06:44:35,823:INFO:   <<< sim_header: meanP
2024-11-09 06:44:35,823:INFO:   <<< sim_lambda: 0.0
2024-11-09 06:44:35,823:INFO:   <<< slice_framepos: 2
2024-11-09 06:44:35,823:INFO:   <<< task_type: retrieval
2024-11-09 06:44:35,823:INFO:   <<< temperature_new: 1.0
2024-11-09 06:44:35,823:INFO:   <<< text_num_hidden_layers: 12
2024-11-09 06:44:35,823:INFO:   <<< time_embedding: 0
2024-11-09 06:44:35,823:INFO:   <<< train_csv: data/.train.csv
2024-11-09 06:44:35,824:INFO:   <<< train_frame_order: 0
2024-11-09 06:44:35,824:INFO:   <<< use_mil: False
2024-11-09 06:44:35,824:INFO:   <<< val_csv: data/.val.csv
2024-11-09 06:44:35,824:INFO:   <<< video_dim: 1024
2024-11-09 06:44:35,824:INFO:   <<< visual_num_hidden_layers: 12
2024-11-09 06:44:35,824:INFO:   <<< warmup_proportion: 0.1
2024-11-09 06:44:35,824:INFO:   <<< world_size: 4
2024-11-09 06:44:35,948:INFO: device: cuda:0 n_gpu: 4
2024-11-09 06:44:35,959:INFO: device: cuda:1 n_gpu: 4
2024-11-09 06:44:35,962:INFO: device: cuda:3 n_gpu: 4
2024-11-09 06:44:35,974:INFO: device: cuda:2 n_gpu: 4
2024-11-09 06:44:38,268:INFO: loading archive file /home/zyl/flexible_k/modules/cross-base
2024-11-09 06:44:38,268:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-09 06:44:38,268:INFO: Weight doesn't exsits. /home/zyl/flexible_k/modules/cross-base/cross_pytorch_model.bin
2024-11-09 06:44:38,269:WARNING: Stage-One:True, Stage-Two:False
2024-11-09 06:44:38,269:WARNING: Test retrieval by loose type.
2024-11-09 06:44:38,269:WARNING: 	 embed_dim: 512
2024-11-09 06:44:38,269:WARNING: 	 image_resolution: 224
2024-11-09 06:44:38,269:WARNING: 	 vision_layers: 12
2024-11-09 06:44:38,269:WARNING: 	 vision_width: 768
2024-11-09 06:44:38,269:WARNING: 	 vision_patch_size: 32
2024-11-09 06:44:38,269:WARNING: 	 context_length: 77
2024-11-09 06:44:38,269:WARNING: 	 vocab_size: 49408
2024-11-09 06:44:38,269:WARNING: 	 transformer_width: 512
2024-11-09 06:44:38,269:WARNING: 	 transformer_heads: 8
2024-11-09 06:44:38,269:WARNING: 	 transformer_layers: 12
2024-11-09 06:44:38,269:WARNING: 		 linear_patch: 2d
2024-11-09 06:44:38,269:WARNING: 	 cut_top_layer: 0
2024-11-09 06:44:40,525:WARNING: 	 sim_header: meanP
2024-11-09 06:44:45,259:INFO: --------------------
2024-11-09 06:44:45,259:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-09 06:44:47,164:INFO: ***** Running test *****
2024-11-09 06:44:47,164:INFO:   Num examples = 1334
2024-11-09 06:44:47,164:INFO:   Batch size = 16
2024-11-09 06:44:47,164:INFO:   Num steps = 334
2024-11-09 06:44:47,164:INFO: ***** Running val *****
2024-11-09 06:44:47,164:INFO:   Num examples = 1334
2024-11-09 06:44:49,474:INFO: ***** Running training *****
2024-11-09 06:44:49,474:INFO:   Num examples = 5338
2024-11-09 06:44:49,474:INFO:   Batch size = 16
2024-11-09 06:44:49,474:INFO:   Num steps = 1998
2024-11-09 06:48:38,552:INFO: Effective parameters:
2024-11-09 06:48:38,552:INFO:   <<< K: 16
2024-11-09 06:48:38,552:INFO:   <<< adaptive_cls: 0
2024-11-09 06:48:38,552:INFO:   <<< aggregation: None
2024-11-09 06:48:38,552:INFO:   <<< alpha: 1.0
2024-11-09 06:48:38,552:INFO:   <<< batch_size: 16
2024-11-09 06:48:38,552:INFO:   <<< batch_size_val: 16
2024-11-09 06:48:38,552:INFO:   <<< cache_dir: 
2024-11-09 06:48:38,552:INFO:   <<< cluser_embed_from_clip: 1
2024-11-09 06:48:38,552:INFO:   <<< cluster_algo: kmediods++
2024-11-09 06:48:38,552:INFO:   <<< cluster_distance: euclidean
2024-11-09 06:48:38,552:INFO:   <<< cluster_embedding: 0
2024-11-09 06:48:38,552:INFO:   <<< cluster_frame_embedding: 0
2024-11-09 06:48:38,552:INFO:   <<< cluster_iter_limit: 100
2024-11-09 06:48:38,552:INFO:   <<< cluster_threshold: 1e-05
2024-11-09 06:48:38,553:INFO:   <<< coef_lr: 0.0001
2024-11-09 06:48:38,553:INFO:   <<< cross_model: cross-base
2024-11-09 06:48:38,553:INFO:   <<< cross_num_hidden_layers: 4
2024-11-09 06:48:38,553:INFO:   <<< data_path: /home/zyl/MeVTR_data_and_models/charades/annotation
2024-11-09 06:48:38,553:INFO:   <<< datatype: charades
2024-11-09 06:48:38,553:INFO:   <<< do_eval: False
2024-11-09 06:48:38,553:INFO:   <<< do_lower_case: False
2024-11-09 06:48:38,553:INFO:   <<< do_pretrain: False
2024-11-09 06:48:38,553:INFO:   <<< do_train: True
2024-11-09 06:48:38,553:INFO:   <<< dynamic_alpha: False
2024-11-09 06:48:38,553:INFO:   <<< epochs: 6
2024-11-09 06:48:38,553:INFO:   <<< eval_frame_order: 0
2024-11-09 06:48:38,553:INFO:   <<< expand_msrvtt_sentences: False
2024-11-09 06:48:38,553:INFO:   <<< feature_framerate: 1
2024-11-09 06:48:38,553:INFO:   <<< features_path: /home/zyl/MeVTR_data_and_models/charades/Charades_v2_3
2024-11-09 06:48:38,553:INFO:   <<< fp16: False
2024-11-09 06:48:38,553:INFO:   <<< fp16_opt_level: O1
2024-11-09 06:48:38,553:INFO:   <<< freeze_layer_num: 0
2024-11-09 06:48:38,553:INFO:   <<< global_info: False
2024-11-09 06:48:38,553:INFO:   <<< gradient_accumulation_steps: 1
2024-11-09 06:48:38,553:INFO:   <<< hard_negative_rate: 0.5
2024-11-09 06:48:38,553:INFO:   <<< init_model: None
2024-11-09 06:48:38,553:INFO:   <<< linear_patch: 2d
2024-11-09 06:48:38,553:INFO:   <<< local_rank: 0
2024-11-09 06:48:38,553:INFO:   <<< loose_type: True
2024-11-09 06:48:38,554:INFO:   <<< loss: balanced
2024-11-09 06:48:38,554:INFO:   <<< lr: 0.0001
2024-11-09 06:48:38,554:INFO:   <<< lr_decay: 0.9
2024-11-09 06:48:38,554:INFO:   <<< margin: 0.1
2024-11-09 06:48:38,554:INFO:   <<< max_frames: 64
2024-11-09 06:48:38,554:INFO:   <<< max_words: 77
2024-11-09 06:48:38,554:INFO:   <<< minkowski_norm_p: 2.0
2024-11-09 06:48:38,554:INFO:   <<< n_display: 100
2024-11-09 06:48:38,554:INFO:   <<< n_gpu: 1
2024-11-09 06:48:38,554:INFO:   <<< n_pair: 1
2024-11-09 06:48:38,554:INFO:   <<< negative_weighting: 1
2024-11-09 06:48:38,554:INFO:   <<< num_thread_reader: 2
2024-11-09 06:48:38,554:INFO:   <<< output_dir: /home/zyl/flexible_k/output_debug
2024-11-09 06:48:38,554:INFO:   <<< post_cluster_centroids: 16
2024-11-09 06:48:38,554:INFO:   <<< post_process: topk
2024-11-09 06:48:38,554:INFO:   <<< pre_norm: 0
2024-11-09 06:48:38,554:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-09 06:48:38,554:INFO:   <<< rank: 0
2024-11-09 06:48:38,554:INFO:   <<< regularize: none
2024-11-09 06:48:38,554:INFO:   <<< resume_model: None
2024-11-09 06:48:38,554:INFO:   <<< sampled_use_mil: False
2024-11-09 06:48:38,554:INFO:   <<< save_feature_path: None
2024-11-09 06:48:38,554:INFO:   <<< seed: 42
2024-11-09 06:48:38,554:INFO:   <<< shuffle_events: False
2024-11-09 06:48:38,554:INFO:   <<< shuffle_exp: False
2024-11-09 06:48:38,554:INFO:   <<< sim_header: meanP
2024-11-09 06:48:38,554:INFO:   <<< sim_lambda: 0.0
2024-11-09 06:48:38,554:INFO:   <<< slice_framepos: 2
2024-11-09 06:48:38,554:INFO:   <<< task_type: retrieval
2024-11-09 06:48:38,554:INFO:   <<< temperature_new: 1.0
2024-11-09 06:48:38,555:INFO:   <<< text_num_hidden_layers: 12
2024-11-09 06:48:38,555:INFO:   <<< time_embedding: 0
2024-11-09 06:48:38,555:INFO:   <<< train_csv: data/.train.csv
2024-11-09 06:48:38,555:INFO:   <<< train_frame_order: 0
2024-11-09 06:48:38,555:INFO:   <<< use_mil: False
2024-11-09 06:48:38,555:INFO:   <<< val_csv: data/.val.csv
2024-11-09 06:48:38,555:INFO:   <<< video_dim: 1024
2024-11-09 06:48:38,555:INFO:   <<< visual_num_hidden_layers: 12
2024-11-09 06:48:38,555:INFO:   <<< warmup_proportion: 0.1
2024-11-09 06:48:38,555:INFO:   <<< world_size: 4
2024-11-09 06:48:38,650:INFO: device: cuda:2 n_gpu: 4
2024-11-09 06:48:38,663:INFO: device: cuda:1 n_gpu: 4
2024-11-09 06:48:38,679:INFO: device: cuda:0 n_gpu: 4
2024-11-09 06:48:38,679:INFO: device: cuda:3 n_gpu: 4
2024-11-09 06:48:41,121:INFO: loading archive file /home/zyl/flexible_k/modules/cross-base
2024-11-09 06:48:41,122:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-09 06:48:41,122:INFO: Weight doesn't exsits. /home/zyl/flexible_k/modules/cross-base/cross_pytorch_model.bin
2024-11-09 06:48:41,122:WARNING: Stage-One:True, Stage-Two:False
2024-11-09 06:48:41,122:WARNING: Test retrieval by loose type.
2024-11-09 06:48:41,122:WARNING: 	 embed_dim: 512
2024-11-09 06:48:41,122:WARNING: 	 image_resolution: 224
2024-11-09 06:48:41,122:WARNING: 	 vision_layers: 12
2024-11-09 06:48:41,122:WARNING: 	 vision_width: 768
2024-11-09 06:48:41,122:WARNING: 	 vision_patch_size: 32
2024-11-09 06:48:41,122:WARNING: 	 context_length: 77
2024-11-09 06:48:41,122:WARNING: 	 vocab_size: 49408
2024-11-09 06:48:41,122:WARNING: 	 transformer_width: 512
2024-11-09 06:48:41,122:WARNING: 	 transformer_heads: 8
2024-11-09 06:48:41,122:WARNING: 	 transformer_layers: 12
2024-11-09 06:48:41,123:WARNING: 		 linear_patch: 2d
2024-11-09 06:48:41,123:WARNING: 	 cut_top_layer: 0
2024-11-09 06:48:43,360:WARNING: 	 sim_header: meanP
2024-11-09 06:48:48,081:INFO: --------------------
2024-11-09 06:48:48,082:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-09 06:48:49,620:INFO: ***** Running test *****
2024-11-09 06:48:49,620:INFO:   Num examples = 1334
2024-11-09 06:48:49,620:INFO:   Batch size = 16
2024-11-09 06:48:49,620:INFO:   Num steps = 334
2024-11-09 06:48:49,620:INFO: ***** Running val *****
2024-11-09 06:48:49,620:INFO:   Num examples = 1334
2024-11-09 06:48:52,645:INFO: ***** Running training *****
2024-11-09 06:48:52,645:INFO:   Num examples = 5338
2024-11-09 06:48:52,645:INFO:   Batch size = 16
2024-11-09 06:48:52,645:INFO:   Num steps = 1998
2024-11-09 07:08:09,581:INFO: Epoch: 1/6, Step: 100/333, Lr: , Loss: 2.800001, 1.871067, Reg Loss: 0.000000, Time/step: 11.569146
2024-11-09 07:16:33,377:INFO: Effective parameters:
2024-11-09 07:16:33,377:INFO:   <<< K: 16
2024-11-09 07:16:33,377:INFO:   <<< adaptive_cls: 0
2024-11-09 07:16:33,377:INFO:   <<< aggregation: None
2024-11-09 07:16:33,378:INFO:   <<< alpha: 1.0
2024-11-09 07:16:33,378:INFO:   <<< batch_size: 16
2024-11-09 07:16:33,378:INFO:   <<< batch_size_val: 16
2024-11-09 07:16:33,378:INFO:   <<< cache_dir: 
2024-11-09 07:16:33,378:INFO:   <<< cluser_embed_from_clip: 1
2024-11-09 07:16:33,378:INFO:   <<< cluster_algo: kmediods++
2024-11-09 07:16:33,378:INFO:   <<< cluster_distance: euclidean
2024-11-09 07:16:33,378:INFO:   <<< cluster_embedding: 0
2024-11-09 07:16:33,378:INFO:   <<< cluster_frame_embedding: 0
2024-11-09 07:16:33,378:INFO:   <<< cluster_iter_limit: 100
2024-11-09 07:16:33,378:INFO:   <<< cluster_threshold: 1e-05
2024-11-09 07:16:33,378:INFO:   <<< coef_lr: 0.0001
2024-11-09 07:16:33,378:INFO:   <<< cross_model: cross-base
2024-11-09 07:16:33,378:INFO:   <<< cross_num_hidden_layers: 4
2024-11-09 07:16:33,378:INFO:   <<< data_path: /home/zyl/MeVTR_data_and_models/charades/annotation
2024-11-09 07:16:33,378:INFO:   <<< datatype: charades
2024-11-09 07:16:33,378:INFO:   <<< do_eval: False
2024-11-09 07:16:33,378:INFO:   <<< do_lower_case: False
2024-11-09 07:16:33,378:INFO:   <<< do_pretrain: False
2024-11-09 07:16:33,378:INFO:   <<< do_train: True
2024-11-09 07:16:33,378:INFO:   <<< dynamic_alpha: False
2024-11-09 07:16:33,378:INFO:   <<< epochs: 6
2024-11-09 07:16:33,379:INFO:   <<< eval_frame_order: 0
2024-11-09 07:16:33,379:INFO:   <<< expand_msrvtt_sentences: False
2024-11-09 07:16:33,379:INFO:   <<< feature_framerate: 1
2024-11-09 07:16:33,379:INFO:   <<< features_path: /home/zyl/MeVTR_data_and_models/charades/Charades_v2_3
2024-11-09 07:16:33,379:INFO:   <<< fp16: False
2024-11-09 07:16:33,379:INFO:   <<< fp16_opt_level: O1
2024-11-09 07:16:33,379:INFO:   <<< freeze_layer_num: 0
2024-11-09 07:16:33,379:INFO:   <<< global_info: False
2024-11-09 07:16:33,379:INFO:   <<< gradient_accumulation_steps: 1
2024-11-09 07:16:33,379:INFO:   <<< hard_negative_rate: 0.5
2024-11-09 07:16:33,379:INFO:   <<< init_model: None
2024-11-09 07:16:33,379:INFO:   <<< linear_patch: 2d
2024-11-09 07:16:33,379:INFO:   <<< local_rank: 0
2024-11-09 07:16:33,379:INFO:   <<< loose_type: True
2024-11-09 07:16:33,379:INFO:   <<< loss: balanced
2024-11-09 07:16:33,379:INFO:   <<< lr: 0.0001
2024-11-09 07:16:33,379:INFO:   <<< lr_decay: 0.9
2024-11-09 07:16:33,379:INFO:   <<< margin: 0.1
2024-11-09 07:16:33,379:INFO:   <<< max_frames: 64
2024-11-09 07:16:33,379:INFO:   <<< max_words: 77
2024-11-09 07:16:33,379:INFO:   <<< minkowski_norm_p: 2.0
2024-11-09 07:16:33,379:INFO:   <<< n_display: 100
2024-11-09 07:16:33,379:INFO:   <<< n_gpu: 1
2024-11-09 07:16:33,379:INFO:   <<< n_pair: 1
2024-11-09 07:16:33,380:INFO:   <<< negative_weighting: 1
2024-11-09 07:16:33,380:INFO:   <<< num_thread_reader: 2
2024-11-09 07:16:33,380:INFO:   <<< output_dir: /home/zyl/flexible_k/output_debug
2024-11-09 07:16:33,380:INFO:   <<< post_cluster_centroids: 16
2024-11-09 07:16:33,380:INFO:   <<< post_process: topk
2024-11-09 07:16:33,380:INFO:   <<< pre_norm: 0
2024-11-09 07:16:33,380:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-09 07:16:33,380:INFO:   <<< rank: 0
2024-11-09 07:16:33,380:INFO:   <<< regularize: none
2024-11-09 07:16:33,380:INFO:   <<< resume_model: None
2024-11-09 07:16:33,380:INFO:   <<< sampled_use_mil: False
2024-11-09 07:16:33,380:INFO:   <<< save_feature_path: None
2024-11-09 07:16:33,380:INFO:   <<< seed: 42
2024-11-09 07:16:33,380:INFO:   <<< shuffle_events: False
2024-11-09 07:16:33,380:INFO:   <<< shuffle_exp: False
2024-11-09 07:16:33,380:INFO:   <<< sim_header: meanP
2024-11-09 07:16:33,380:INFO:   <<< sim_lambda: 0.0
2024-11-09 07:16:33,380:INFO:   <<< slice_framepos: 2
2024-11-09 07:16:33,380:INFO:   <<< task_type: retrieval
2024-11-09 07:16:33,380:INFO:   <<< temperature_new: 1.0
2024-11-09 07:16:33,380:INFO:   <<< text_num_hidden_layers: 12
2024-11-09 07:16:33,380:INFO:   <<< time_embedding: 0
2024-11-09 07:16:33,380:INFO:   <<< train_csv: data/.train.csv
2024-11-09 07:16:33,380:INFO:   <<< train_frame_order: 0
2024-11-09 07:16:33,381:INFO:   <<< use_mil: False
2024-11-09 07:16:33,381:INFO:   <<< val_csv: data/.val.csv
2024-11-09 07:16:33,381:INFO:   <<< video_dim: 1024
2024-11-09 07:16:33,381:INFO:   <<< visual_num_hidden_layers: 12
2024-11-09 07:16:33,381:INFO:   <<< warmup_proportion: 0.1
2024-11-09 07:16:33,381:INFO:   <<< world_size: 4
2024-11-09 07:16:33,506:INFO: device: cuda:2 n_gpu: 4
2024-11-09 07:16:33,512:INFO: device: cuda:0 n_gpu: 4
2024-11-09 07:16:33,604:INFO: device: cuda:1 n_gpu: 4
2024-11-09 07:16:33,614:INFO: device: cuda:3 n_gpu: 4
2024-11-09 07:16:36,073:INFO: loading archive file /home/zyl/flexible_k/modules/cross-base
2024-11-09 07:16:36,074:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-09 07:16:36,074:INFO: Weight doesn't exsits. /home/zyl/flexible_k/modules/cross-base/cross_pytorch_model.bin
2024-11-09 07:16:36,075:WARNING: Stage-One:True, Stage-Two:False
2024-11-09 07:16:36,075:WARNING: Test retrieval by loose type.
2024-11-09 07:16:36,075:WARNING: 	 embed_dim: 512
2024-11-09 07:16:36,075:WARNING: 	 image_resolution: 224
2024-11-09 07:16:36,075:WARNING: 	 vision_layers: 12
2024-11-09 07:16:36,075:WARNING: 	 vision_width: 768
2024-11-09 07:16:36,075:WARNING: 	 vision_patch_size: 32
2024-11-09 07:16:36,075:WARNING: 	 context_length: 77
2024-11-09 07:16:36,075:WARNING: 	 vocab_size: 49408
2024-11-09 07:16:36,075:WARNING: 	 transformer_width: 512
2024-11-09 07:16:36,076:WARNING: 	 transformer_heads: 8
2024-11-09 07:16:36,076:WARNING: 	 transformer_layers: 12
2024-11-09 07:16:36,076:WARNING: 		 linear_patch: 2d
2024-11-09 07:16:36,076:WARNING: 	 cut_top_layer: 0
2024-11-09 07:16:38,428:WARNING: 	 sim_header: meanP
2024-11-09 07:16:43,266:INFO: --------------------
2024-11-09 07:16:43,267:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-09 07:16:45,072:INFO: ***** Running test *****
2024-11-09 07:16:45,073:INFO:   Num examples = 1334
2024-11-09 07:16:45,073:INFO:   Batch size = 16
2024-11-09 07:16:45,073:INFO:   Num steps = 334
2024-11-09 07:16:45,073:INFO: ***** Running val *****
2024-11-09 07:16:45,073:INFO:   Num examples = 1334
2024-11-09 07:16:47,801:INFO: ***** Running training *****
2024-11-09 07:16:47,802:INFO:   Num examples = 5338
2024-11-09 07:16:47,802:INFO:   Batch size = 16
2024-11-09 07:16:47,802:INFO:   Num steps = 1998
2024-11-09 07:37:08,215:INFO: Epoch: 1/6, Step: 100/333, Lr: , Loss: 2.800001, 1.871067, Reg Loss: 0.000000, Time/step: 12.203842
2024-11-09 08:36:15,312:INFO: Effective parameters:
2024-11-09 08:36:15,312:INFO:   <<< K: 16
2024-11-09 08:36:15,312:INFO:   <<< adaptive_cls: 0
2024-11-09 08:36:15,312:INFO:   <<< aggregation: None
2024-11-09 08:36:15,312:INFO:   <<< alpha: 1.0
2024-11-09 08:36:15,312:INFO:   <<< batch_size: 16
2024-11-09 08:36:15,312:INFO:   <<< batch_size_val: 16
2024-11-09 08:36:15,312:INFO:   <<< cache_dir: 
2024-11-09 08:36:15,312:INFO:   <<< cluser_embed_from_clip: 1
2024-11-09 08:36:15,312:INFO:   <<< cluster_algo: kmediods++
2024-11-09 08:36:15,312:INFO:   <<< cluster_distance: euclidean
2024-11-09 08:36:15,312:INFO:   <<< cluster_embedding: 0
2024-11-09 08:36:15,312:INFO:   <<< cluster_frame_embedding: 0
2024-11-09 08:36:15,312:INFO:   <<< cluster_iter_limit: 100
2024-11-09 08:36:15,312:INFO:   <<< cluster_threshold: 1e-05
2024-11-09 08:36:15,312:INFO:   <<< coef_lr: 0.0001
2024-11-09 08:36:15,312:INFO:   <<< cross_model: cross-base
2024-11-09 08:36:15,312:INFO:   <<< cross_num_hidden_layers: 4
2024-11-09 08:36:15,313:INFO:   <<< data_path: /home/zyl/MeVTR_data_and_models/charades/annotation
2024-11-09 08:36:15,313:INFO:   <<< datatype: charades
2024-11-09 08:36:15,313:INFO:   <<< do_eval: False
2024-11-09 08:36:15,313:INFO:   <<< do_lower_case: False
2024-11-09 08:36:15,313:INFO:   <<< do_pretrain: False
2024-11-09 08:36:15,313:INFO:   <<< do_train: True
2024-11-09 08:36:15,313:INFO:   <<< dynamic_alpha: False
2024-11-09 08:36:15,313:INFO:   <<< epochs: 6
2024-11-09 08:36:15,313:INFO:   <<< eval_frame_order: 0
2024-11-09 08:36:15,313:INFO:   <<< expand_msrvtt_sentences: False
2024-11-09 08:36:15,313:INFO:   <<< feature_framerate: 1
2024-11-09 08:36:15,313:INFO:   <<< features_path: /home/zyl/MeVTR_data_and_models/charades/Charades_v2_3
2024-11-09 08:36:15,313:INFO:   <<< fp16: False
2024-11-09 08:36:15,313:INFO:   <<< fp16_opt_level: O1
2024-11-09 08:36:15,313:INFO:   <<< freeze_layer_num: 0
2024-11-09 08:36:15,313:INFO:   <<< global_info: False
2024-11-09 08:36:15,313:INFO:   <<< gradient_accumulation_steps: 1
2024-11-09 08:36:15,313:INFO:   <<< hard_negative_rate: 0.5
2024-11-09 08:36:15,313:INFO:   <<< init_model: None
2024-11-09 08:36:15,313:INFO:   <<< linear_patch: 2d
2024-11-09 08:36:15,313:INFO:   <<< local_rank: 0
2024-11-09 08:36:15,313:INFO:   <<< loose_type: True
2024-11-09 08:36:15,313:INFO:   <<< loss: balanced
2024-11-09 08:36:15,313:INFO:   <<< lr: 0.0001
2024-11-09 08:36:15,313:INFO:   <<< lr_decay: 0.9
2024-11-09 08:36:15,313:INFO:   <<< margin: 0.1
2024-11-09 08:36:15,313:INFO:   <<< max_frames: 64
2024-11-09 08:36:15,313:INFO:   <<< max_words: 77
2024-11-09 08:36:15,314:INFO:   <<< minkowski_norm_p: 2.0
2024-11-09 08:36:15,314:INFO:   <<< n_display: 100
2024-11-09 08:36:15,314:INFO:   <<< n_gpu: 1
2024-11-09 08:36:15,314:INFO:   <<< n_pair: 1
2024-11-09 08:36:15,314:INFO:   <<< negative_weighting: 1
2024-11-09 08:36:15,314:INFO:   <<< num_thread_reader: 2
2024-11-09 08:36:15,314:INFO:   <<< output_dir: /home/zyl/flexible_k/output_debug
2024-11-09 08:36:15,314:INFO:   <<< post_cluster_centroids: 16
2024-11-09 08:36:15,314:INFO:   <<< post_process: topk
2024-11-09 08:36:15,314:INFO:   <<< pre_norm: 0
2024-11-09 08:36:15,314:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-09 08:36:15,314:INFO:   <<< rank: 0
2024-11-09 08:36:15,314:INFO:   <<< regularize: none
2024-11-09 08:36:15,314:INFO:   <<< resume_model: None
2024-11-09 08:36:15,314:INFO:   <<< sampled_use_mil: False
2024-11-09 08:36:15,314:INFO:   <<< save_feature_path: None
2024-11-09 08:36:15,314:INFO:   <<< seed: 42
2024-11-09 08:36:15,314:INFO:   <<< shuffle_events: False
2024-11-09 08:36:15,314:INFO:   <<< shuffle_exp: False
2024-11-09 08:36:15,314:INFO:   <<< sim_header: meanP
2024-11-09 08:36:15,314:INFO:   <<< sim_lambda: 0.0
2024-11-09 08:36:15,314:INFO:   <<< slice_framepos: 2
2024-11-09 08:36:15,314:INFO:   <<< task_type: retrieval
2024-11-09 08:36:15,314:INFO:   <<< temperature_new: 1.0
2024-11-09 08:36:15,314:INFO:   <<< text_num_hidden_layers: 12
2024-11-09 08:36:15,314:INFO:   <<< time_embedding: 0
2024-11-09 08:36:15,314:INFO:   <<< train_csv: data/.train.csv
2024-11-09 08:36:15,314:INFO:   <<< train_frame_order: 0
2024-11-09 08:36:15,315:INFO:   <<< use_mil: False
2024-11-09 08:36:15,315:INFO:   <<< val_csv: data/.val.csv
2024-11-09 08:36:15,315:INFO:   <<< video_dim: 1024
2024-11-09 08:36:15,315:INFO:   <<< visual_num_hidden_layers: 12
2024-11-09 08:36:15,315:INFO:   <<< warmup_proportion: 0.1
2024-11-09 08:36:15,315:INFO:   <<< world_size: 4
2024-11-09 08:36:15,435:INFO: device: cuda:3 n_gpu: 4
2024-11-09 08:36:15,437:INFO: device: cuda:0 n_gpu: 4
2024-11-09 08:36:15,493:INFO: device: cuda:2 n_gpu: 4
2024-11-09 08:36:15,518:INFO: device: cuda:1 n_gpu: 4
2024-11-09 08:36:18,001:INFO: loading archive file /home/zyl/flexible_k/modules/cross-base
2024-11-09 08:36:18,002:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-09 08:36:18,003:INFO: Weight doesn't exsits. /home/zyl/flexible_k/modules/cross-base/cross_pytorch_model.bin
2024-11-09 08:36:18,003:WARNING: Stage-One:True, Stage-Two:False
2024-11-09 08:36:18,003:WARNING: Test retrieval by loose type.
2024-11-09 08:36:18,003:WARNING: 	 embed_dim: 512
2024-11-09 08:36:18,004:WARNING: 	 image_resolution: 224
2024-11-09 08:36:18,004:WARNING: 	 vision_layers: 12
2024-11-09 08:36:18,004:WARNING: 	 vision_width: 768
2024-11-09 08:36:18,004:WARNING: 	 vision_patch_size: 32
2024-11-09 08:36:18,004:WARNING: 	 context_length: 77
2024-11-09 08:36:18,004:WARNING: 	 vocab_size: 49408
2024-11-09 08:36:18,004:WARNING: 	 transformer_width: 512
2024-11-09 08:36:18,004:WARNING: 	 transformer_heads: 8
2024-11-09 08:36:18,004:WARNING: 	 transformer_layers: 12
2024-11-09 08:36:18,004:WARNING: 		 linear_patch: 2d
2024-11-09 08:36:18,004:WARNING: 	 cut_top_layer: 0
2024-11-09 08:36:20,854:WARNING: 	 sim_header: meanP
2024-11-09 08:36:25,702:INFO: --------------------
2024-11-09 08:36:25,703:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-09 08:36:27,151:INFO: ***** Running test *****
2024-11-09 08:36:27,151:INFO:   Num examples = 1334
2024-11-09 08:36:27,151:INFO:   Batch size = 16
2024-11-09 08:36:27,151:INFO:   Num steps = 334
2024-11-09 08:36:27,151:INFO: ***** Running val *****
2024-11-09 08:36:27,151:INFO:   Num examples = 1334
2024-11-09 08:36:29,616:INFO: ***** Running training *****
2024-11-09 08:36:29,616:INFO:   Num examples = 5338
2024-11-09 08:36:29,617:INFO:   Batch size = 16
2024-11-09 08:36:29,617:INFO:   Num steps = 1998
2024-11-09 08:37:51,998:INFO: Effective parameters:
2024-11-09 08:37:51,998:INFO:   <<< K: 16
2024-11-09 08:37:51,998:INFO:   <<< adaptive_cls: 0
2024-11-09 08:37:51,998:INFO:   <<< aggregation: None
2024-11-09 08:37:51,998:INFO:   <<< alpha: 1.0
2024-11-09 08:37:51,998:INFO:   <<< batch_size: 16
2024-11-09 08:37:51,998:INFO:   <<< batch_size_val: 16
2024-11-09 08:37:51,998:INFO:   <<< cache_dir: 
2024-11-09 08:37:51,998:INFO:   <<< cluser_embed_from_clip: 1
2024-11-09 08:37:51,998:INFO:   <<< cluster_algo: kmediods++
2024-11-09 08:37:51,998:INFO:   <<< cluster_distance: euclidean
2024-11-09 08:37:51,998:INFO:   <<< cluster_embedding: 0
2024-11-09 08:37:51,998:INFO:   <<< cluster_frame_embedding: 0
2024-11-09 08:37:51,998:INFO:   <<< cluster_iter_limit: 100
2024-11-09 08:37:51,998:INFO:   <<< cluster_threshold: 1e-05
2024-11-09 08:37:51,999:INFO:   <<< coef_lr: 0.0001
2024-11-09 08:37:51,999:INFO:   <<< cross_model: cross-base
2024-11-09 08:37:51,999:INFO:   <<< cross_num_hidden_layers: 4
2024-11-09 08:37:51,999:INFO:   <<< data_path: /home/zyl/MeVTR_data_and_models/charades/annotation
2024-11-09 08:37:51,999:INFO:   <<< datatype: charades
2024-11-09 08:37:51,999:INFO:   <<< do_eval: False
2024-11-09 08:37:51,999:INFO:   <<< do_lower_case: False
2024-11-09 08:37:51,999:INFO:   <<< do_pretrain: False
2024-11-09 08:37:51,999:INFO:   <<< do_train: True
2024-11-09 08:37:51,999:INFO:   <<< dynamic_alpha: False
2024-11-09 08:37:51,999:INFO:   <<< epochs: 6
2024-11-09 08:37:51,999:INFO:   <<< eval_frame_order: 0
2024-11-09 08:37:51,999:INFO:   <<< expand_msrvtt_sentences: False
2024-11-09 08:37:51,999:INFO:   <<< feature_framerate: 1
2024-11-09 08:37:51,999:INFO:   <<< features_path: /home/zyl/MeVTR_data_and_models/charades/Charades_v2_3
2024-11-09 08:37:51,999:INFO:   <<< fp16: False
2024-11-09 08:37:51,999:INFO:   <<< fp16_opt_level: O1
2024-11-09 08:37:51,999:INFO:   <<< freeze_layer_num: 0
2024-11-09 08:37:51,999:INFO:   <<< global_info: False
2024-11-09 08:37:51,999:INFO:   <<< gradient_accumulation_steps: 1
2024-11-09 08:37:51,999:INFO:   <<< hard_negative_rate: 0.5
2024-11-09 08:37:51,999:INFO:   <<< init_model: None
2024-11-09 08:37:51,999:INFO:   <<< linear_patch: 2d
2024-11-09 08:37:51,999:INFO:   <<< local_rank: 0
2024-11-09 08:37:51,999:INFO:   <<< loose_type: True
2024-11-09 08:37:51,999:INFO:   <<< loss: balanced
2024-11-09 08:37:51,999:INFO:   <<< lr: 0.0001
2024-11-09 08:37:51,999:INFO:   <<< lr_decay: 0.9
2024-11-09 08:37:52,000:INFO:   <<< margin: 0.1
2024-11-09 08:37:52,000:INFO:   <<< max_frames: 64
2024-11-09 08:37:52,000:INFO:   <<< max_words: 77
2024-11-09 08:37:52,000:INFO:   <<< minkowski_norm_p: 2.0
2024-11-09 08:37:52,000:INFO:   <<< n_display: 100
2024-11-09 08:37:52,000:INFO:   <<< n_gpu: 1
2024-11-09 08:37:52,000:INFO:   <<< n_pair: 1
2024-11-09 08:37:52,000:INFO:   <<< negative_weighting: 1
2024-11-09 08:37:52,000:INFO:   <<< num_thread_reader: 2
2024-11-09 08:37:52,000:INFO:   <<< output_dir: /home/zyl/flexible_k/output_debug
2024-11-09 08:37:52,000:INFO:   <<< post_cluster_centroids: 16
2024-11-09 08:37:52,000:INFO:   <<< post_process: topk
2024-11-09 08:37:52,000:INFO:   <<< pre_norm: 0
2024-11-09 08:37:52,000:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-09 08:37:52,000:INFO:   <<< rank: 0
2024-11-09 08:37:52,000:INFO:   <<< regularize: none
2024-11-09 08:37:52,000:INFO:   <<< resume_model: None
2024-11-09 08:37:52,000:INFO:   <<< sampled_use_mil: False
2024-11-09 08:37:52,000:INFO:   <<< save_feature_path: None
2024-11-09 08:37:52,000:INFO:   <<< seed: 42
2024-11-09 08:37:52,000:INFO:   <<< shuffle_events: False
2024-11-09 08:37:52,000:INFO:   <<< shuffle_exp: False
2024-11-09 08:37:52,000:INFO:   <<< sim_header: meanP
2024-11-09 08:37:52,000:INFO:   <<< sim_lambda: 0.0
2024-11-09 08:37:52,000:INFO:   <<< slice_framepos: 2
2024-11-09 08:37:52,000:INFO:   <<< task_type: retrieval
2024-11-09 08:37:52,000:INFO:   <<< temperature_new: 1.0
2024-11-09 08:37:52,000:INFO:   <<< text_num_hidden_layers: 12
2024-11-09 08:37:52,000:INFO:   <<< time_embedding: 0
2024-11-09 08:37:52,000:INFO:   <<< train_csv: data/.train.csv
2024-11-09 08:37:52,001:INFO:   <<< train_frame_order: 0
2024-11-09 08:37:52,001:INFO:   <<< use_mil: False
2024-11-09 08:37:52,001:INFO:   <<< val_csv: data/.val.csv
2024-11-09 08:37:52,001:INFO:   <<< video_dim: 1024
2024-11-09 08:37:52,001:INFO:   <<< visual_num_hidden_layers: 12
2024-11-09 08:37:52,001:INFO:   <<< warmup_proportion: 0.1
2024-11-09 08:37:52,001:INFO:   <<< world_size: 4
2024-11-09 08:37:52,122:INFO: device: cuda:1 n_gpu: 4
2024-11-09 08:37:52,123:INFO: device: cuda:3 n_gpu: 4
2024-11-09 08:37:52,145:INFO: device: cuda:0 n_gpu: 4
2024-11-09 08:37:52,153:INFO: device: cuda:2 n_gpu: 4
2024-11-09 08:37:54,463:INFO: loading archive file /home/zyl/flexible_k/modules/cross-base
2024-11-09 08:37:54,464:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-09 08:37:54,464:INFO: Weight doesn't exsits. /home/zyl/flexible_k/modules/cross-base/cross_pytorch_model.bin
2024-11-09 08:37:54,464:WARNING: Stage-One:True, Stage-Two:False
2024-11-09 08:37:54,464:WARNING: Test retrieval by loose type.
2024-11-09 08:37:54,464:WARNING: 	 embed_dim: 512
2024-11-09 08:37:54,464:WARNING: 	 image_resolution: 224
2024-11-09 08:37:54,464:WARNING: 	 vision_layers: 12
2024-11-09 08:37:54,464:WARNING: 	 vision_width: 768
2024-11-09 08:37:54,465:WARNING: 	 vision_patch_size: 32
2024-11-09 08:37:54,465:WARNING: 	 context_length: 77
2024-11-09 08:37:54,465:WARNING: 	 vocab_size: 49408
2024-11-09 08:37:54,465:WARNING: 	 transformer_width: 512
2024-11-09 08:37:54,465:WARNING: 	 transformer_heads: 8
2024-11-09 08:37:54,465:WARNING: 	 transformer_layers: 12
2024-11-09 08:37:54,465:WARNING: 		 linear_patch: 2d
2024-11-09 08:37:54,465:WARNING: 	 cut_top_layer: 0
2024-11-09 08:37:56,682:WARNING: 	 sim_header: meanP
2024-11-09 08:38:01,376:INFO: --------------------
2024-11-09 08:38:01,376:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-09 08:38:02,893:INFO: ***** Running test *****
2024-11-09 08:38:02,893:INFO:   Num examples = 1334
2024-11-09 08:38:02,894:INFO:   Batch size = 16
2024-11-09 08:38:02,894:INFO:   Num steps = 334
2024-11-09 08:38:02,894:INFO: ***** Running val *****
2024-11-09 08:38:02,894:INFO:   Num examples = 1334
2024-11-09 08:38:06,234:INFO: ***** Running training *****
2024-11-09 08:38:06,235:INFO:   Num examples = 5338
2024-11-09 08:38:06,235:INFO:   Batch size = 16
2024-11-09 08:38:06,235:INFO:   Num steps = 1998
2024-11-09 08:39:41,262:INFO: Effective parameters:
2024-11-09 08:39:41,262:INFO:   <<< K: 16
2024-11-09 08:39:41,262:INFO:   <<< adaptive_cls: 0
2024-11-09 08:39:41,262:INFO:   <<< aggregation: None
2024-11-09 08:39:41,262:INFO:   <<< alpha: 1.0
2024-11-09 08:39:41,262:INFO:   <<< batch_size: 16
2024-11-09 08:39:41,262:INFO:   <<< batch_size_val: 16
2024-11-09 08:39:41,262:INFO:   <<< cache_dir: 
2024-11-09 08:39:41,262:INFO:   <<< cluser_embed_from_clip: 1
2024-11-09 08:39:41,262:INFO:   <<< cluster_algo: kmediods++
2024-11-09 08:39:41,262:INFO:   <<< cluster_distance: euclidean
2024-11-09 08:39:41,262:INFO:   <<< cluster_embedding: 0
2024-11-09 08:39:41,262:INFO:   <<< cluster_frame_embedding: 0
2024-11-09 08:39:41,262:INFO:   <<< cluster_iter_limit: 100
2024-11-09 08:39:41,262:INFO:   <<< cluster_threshold: 1e-05
2024-11-09 08:39:41,262:INFO:   <<< coef_lr: 0.0001
2024-11-09 08:39:41,262:INFO:   <<< cross_model: cross-base
2024-11-09 08:39:41,262:INFO:   <<< cross_num_hidden_layers: 4
2024-11-09 08:39:41,262:INFO:   <<< data_path: /home/zyl/MeVTR_data_and_models/charades/annotation
2024-11-09 08:39:41,263:INFO:   <<< datatype: charades
2024-11-09 08:39:41,263:INFO:   <<< do_eval: False
2024-11-09 08:39:41,263:INFO:   <<< do_lower_case: False
2024-11-09 08:39:41,263:INFO:   <<< do_pretrain: False
2024-11-09 08:39:41,263:INFO:   <<< do_train: True
2024-11-09 08:39:41,263:INFO:   <<< dynamic_alpha: False
2024-11-09 08:39:41,263:INFO:   <<< epochs: 6
2024-11-09 08:39:41,263:INFO:   <<< eval_frame_order: 0
2024-11-09 08:39:41,263:INFO:   <<< expand_msrvtt_sentences: False
2024-11-09 08:39:41,263:INFO:   <<< feature_framerate: 1
2024-11-09 08:39:41,263:INFO:   <<< features_path: /home/zyl/MeVTR_data_and_models/charades/Charades_v2_3
2024-11-09 08:39:41,263:INFO:   <<< fp16: False
2024-11-09 08:39:41,263:INFO:   <<< fp16_opt_level: O1
2024-11-09 08:39:41,263:INFO:   <<< freeze_layer_num: 0
2024-11-09 08:39:41,263:INFO:   <<< global_info: False
2024-11-09 08:39:41,263:INFO:   <<< gradient_accumulation_steps: 1
2024-11-09 08:39:41,263:INFO:   <<< hard_negative_rate: 0.5
2024-11-09 08:39:41,263:INFO:   <<< init_model: None
2024-11-09 08:39:41,263:INFO:   <<< linear_patch: 2d
2024-11-09 08:39:41,263:INFO:   <<< local_rank: 0
2024-11-09 08:39:41,263:INFO:   <<< loose_type: True
2024-11-09 08:39:41,263:INFO:   <<< loss: balanced
2024-11-09 08:39:41,263:INFO:   <<< lr: 0.0001
2024-11-09 08:39:41,263:INFO:   <<< lr_decay: 0.9
2024-11-09 08:39:41,263:INFO:   <<< margin: 0.1
2024-11-09 08:39:41,263:INFO:   <<< max_frames: 64
2024-11-09 08:39:41,263:INFO:   <<< max_words: 77
2024-11-09 08:39:41,263:INFO:   <<< minkowski_norm_p: 2.0
2024-11-09 08:39:41,263:INFO:   <<< n_display: 100
2024-11-09 08:39:41,264:INFO:   <<< n_gpu: 1
2024-11-09 08:39:41,264:INFO:   <<< n_pair: 1
2024-11-09 08:39:41,264:INFO:   <<< negative_weighting: 1
2024-11-09 08:39:41,264:INFO:   <<< num_thread_reader: 2
2024-11-09 08:39:41,264:INFO:   <<< output_dir: /home/zyl/flexible_k/output_debug
2024-11-09 08:39:41,264:INFO:   <<< post_cluster_centroids: 16
2024-11-09 08:39:41,264:INFO:   <<< post_process: topk
2024-11-09 08:39:41,264:INFO:   <<< pre_norm: 0
2024-11-09 08:39:41,264:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-09 08:39:41,264:INFO:   <<< rank: 0
2024-11-09 08:39:41,264:INFO:   <<< regularize: none
2024-11-09 08:39:41,264:INFO:   <<< resume_model: None
2024-11-09 08:39:41,264:INFO:   <<< sampled_use_mil: False
2024-11-09 08:39:41,264:INFO:   <<< save_feature_path: None
2024-11-09 08:39:41,264:INFO:   <<< seed: 42
2024-11-09 08:39:41,264:INFO:   <<< shuffle_events: False
2024-11-09 08:39:41,264:INFO:   <<< shuffle_exp: False
2024-11-09 08:39:41,264:INFO:   <<< sim_header: meanP
2024-11-09 08:39:41,264:INFO:   <<< sim_lambda: 0.0
2024-11-09 08:39:41,264:INFO:   <<< slice_framepos: 2
2024-11-09 08:39:41,264:INFO:   <<< task_type: retrieval
2024-11-09 08:39:41,264:INFO:   <<< temperature_new: 1.0
2024-11-09 08:39:41,264:INFO:   <<< text_num_hidden_layers: 12
2024-11-09 08:39:41,264:INFO:   <<< time_embedding: 0
2024-11-09 08:39:41,264:INFO:   <<< train_csv: data/.train.csv
2024-11-09 08:39:41,264:INFO:   <<< train_frame_order: 0
2024-11-09 08:39:41,264:INFO:   <<< use_mil: False
2024-11-09 08:39:41,264:INFO:   <<< val_csv: data/.val.csv
2024-11-09 08:39:41,264:INFO:   <<< video_dim: 1024
2024-11-09 08:39:41,264:INFO:   <<< visual_num_hidden_layers: 12
2024-11-09 08:39:41,264:INFO:   <<< warmup_proportion: 0.1
2024-11-09 08:39:41,265:INFO:   <<< world_size: 4
2024-11-09 08:39:41,351:INFO: device: cuda:3 n_gpu: 4
2024-11-09 08:39:41,365:INFO: device: cuda:2 n_gpu: 4
2024-11-09 08:39:41,372:INFO: device: cuda:1 n_gpu: 4
2024-11-09 08:39:41,380:INFO: device: cuda:0 n_gpu: 4
2024-11-09 08:39:43,747:INFO: loading archive file /home/zyl/flexible_k/modules/cross-base
2024-11-09 08:39:43,748:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-09 08:39:43,748:INFO: Weight doesn't exsits. /home/zyl/flexible_k/modules/cross-base/cross_pytorch_model.bin
2024-11-09 08:39:43,748:WARNING: Stage-One:True, Stage-Two:False
2024-11-09 08:39:43,748:WARNING: Test retrieval by loose type.
2024-11-09 08:39:43,749:WARNING: 	 embed_dim: 512
2024-11-09 08:39:43,749:WARNING: 	 image_resolution: 224
2024-11-09 08:39:43,749:WARNING: 	 vision_layers: 12
2024-11-09 08:39:43,749:WARNING: 	 vision_width: 768
2024-11-09 08:39:43,749:WARNING: 	 vision_patch_size: 32
2024-11-09 08:39:43,749:WARNING: 	 context_length: 77
2024-11-09 08:39:43,749:WARNING: 	 vocab_size: 49408
2024-11-09 08:39:43,749:WARNING: 	 transformer_width: 512
2024-11-09 08:39:43,749:WARNING: 	 transformer_heads: 8
2024-11-09 08:39:43,749:WARNING: 	 transformer_layers: 12
2024-11-09 08:39:43,750:WARNING: 		 linear_patch: 2d
2024-11-09 08:39:43,750:WARNING: 	 cut_top_layer: 0
2024-11-09 08:39:46,015:WARNING: 	 sim_header: meanP
2024-11-09 08:39:50,670:INFO: --------------------
2024-11-09 08:39:50,670:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-09 08:39:52,262:INFO: ***** Running test *****
2024-11-09 08:39:52,262:INFO:   Num examples = 1334
2024-11-09 08:39:52,262:INFO:   Batch size = 16
2024-11-09 08:39:52,262:INFO:   Num steps = 334
2024-11-09 08:39:52,262:INFO: ***** Running val *****
2024-11-09 08:39:52,262:INFO:   Num examples = 1334
2024-11-09 08:39:54,760:INFO: ***** Running training *****
2024-11-09 08:39:54,760:INFO:   Num examples = 5338
2024-11-09 08:39:54,760:INFO:   Batch size = 16
2024-11-09 08:39:54,760:INFO:   Num steps = 1998
2024-11-09 08:46:56,515:INFO: Effective parameters:
2024-11-09 08:46:56,515:INFO:   <<< K: 16
2024-11-09 08:46:56,516:INFO:   <<< adaptive_cls: 0
2024-11-09 08:46:56,516:INFO:   <<< aggregation: None
2024-11-09 08:46:56,516:INFO:   <<< alpha: 1.0
2024-11-09 08:46:56,516:INFO:   <<< batch_size: 16
2024-11-09 08:46:56,516:INFO:   <<< batch_size_val: 16
2024-11-09 08:46:56,516:INFO:   <<< cache_dir: 
2024-11-09 08:46:56,516:INFO:   <<< cluser_embed_from_clip: 1
2024-11-09 08:46:56,516:INFO:   <<< cluster_algo: kmediods++
2024-11-09 08:46:56,516:INFO:   <<< cluster_distance: euclidean
2024-11-09 08:46:56,516:INFO:   <<< cluster_embedding: 0
2024-11-09 08:46:56,516:INFO:   <<< cluster_frame_embedding: 0
2024-11-09 08:46:56,516:INFO:   <<< cluster_iter_limit: 100
2024-11-09 08:46:56,516:INFO:   <<< cluster_threshold: 1e-05
2024-11-09 08:46:56,516:INFO:   <<< coef_lr: 0.0001
2024-11-09 08:46:56,517:INFO:   <<< cross_model: cross-base
2024-11-09 08:46:56,517:INFO:   <<< cross_num_hidden_layers: 4
2024-11-09 08:46:56,517:INFO:   <<< data_path: /home/zyl/MeVTR_data_and_models/charades/annotation
2024-11-09 08:46:56,517:INFO:   <<< datatype: charades
2024-11-09 08:46:56,517:INFO:   <<< do_eval: False
2024-11-09 08:46:56,517:INFO:   <<< do_lower_case: False
2024-11-09 08:46:56,517:INFO:   <<< do_pretrain: False
2024-11-09 08:46:56,517:INFO:   <<< do_train: True
2024-11-09 08:46:56,517:INFO:   <<< dynamic_alpha: False
2024-11-09 08:46:56,517:INFO:   <<< epochs: 6
2024-11-09 08:46:56,517:INFO:   <<< eval_frame_order: 0
2024-11-09 08:46:56,517:INFO:   <<< expand_msrvtt_sentences: False
2024-11-09 08:46:56,517:INFO:   <<< feature_framerate: 1
2024-11-09 08:46:56,517:INFO:   <<< features_path: /home/zyl/MeVTR_data_and_models/charades/Charades_v2_3
2024-11-09 08:46:56,517:INFO:   <<< fp16: False
2024-11-09 08:46:56,517:INFO:   <<< fp16_opt_level: O1
2024-11-09 08:46:56,517:INFO:   <<< freeze_layer_num: 0
2024-11-09 08:46:56,518:INFO:   <<< global_info: False
2024-11-09 08:46:56,518:INFO:   <<< gradient_accumulation_steps: 1
2024-11-09 08:46:56,518:INFO:   <<< hard_negative_rate: 0.5
2024-11-09 08:46:56,518:INFO:   <<< init_model: None
2024-11-09 08:46:56,518:INFO:   <<< linear_patch: 2d
2024-11-09 08:46:56,518:INFO:   <<< local_rank: 0
2024-11-09 08:46:56,518:INFO:   <<< loose_type: True
2024-11-09 08:46:56,518:INFO:   <<< loss: balanced
2024-11-09 08:46:56,518:INFO:   <<< lr: 0.0001
2024-11-09 08:46:56,518:INFO:   <<< lr_decay: 0.9
2024-11-09 08:46:56,518:INFO:   <<< margin: 0.1
2024-11-09 08:46:56,518:INFO:   <<< max_frames: 64
2024-11-09 08:46:56,518:INFO:   <<< max_words: 77
2024-11-09 08:46:56,518:INFO:   <<< minkowski_norm_p: 2.0
2024-11-09 08:46:56,518:INFO:   <<< n_display: 100
2024-11-09 08:46:56,518:INFO:   <<< n_gpu: 1
2024-11-09 08:46:56,519:INFO:   <<< n_pair: 1
2024-11-09 08:46:56,519:INFO:   <<< negative_weighting: 1
2024-11-09 08:46:56,519:INFO:   <<< num_thread_reader: 2
2024-11-09 08:46:56,519:INFO:   <<< output_dir: /home/zyl/flexible_k/output_debug
2024-11-09 08:46:56,519:INFO:   <<< post_cluster_centroids: 16
2024-11-09 08:46:56,519:INFO:   <<< post_process: topk
2024-11-09 08:46:56,519:INFO:   <<< pre_norm: 0
2024-11-09 08:46:56,519:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-09 08:46:56,519:INFO:   <<< rank: 0
2024-11-09 08:46:56,519:INFO:   <<< regularize: none
2024-11-09 08:46:56,519:INFO:   <<< resume_model: None
2024-11-09 08:46:56,519:INFO:   <<< sampled_use_mil: False
2024-11-09 08:46:56,519:INFO:   <<< save_feature_path: None
2024-11-09 08:46:56,519:INFO:   <<< seed: 42
2024-11-09 08:46:56,519:INFO:   <<< shuffle_events: False
2024-11-09 08:46:56,519:INFO:   <<< shuffle_exp: False
2024-11-09 08:46:56,519:INFO:   <<< sim_header: meanP
2024-11-09 08:46:56,520:INFO:   <<< sim_lambda: 0.0
2024-11-09 08:46:56,520:INFO:   <<< slice_framepos: 2
2024-11-09 08:46:56,520:INFO:   <<< task_type: retrieval
2024-11-09 08:46:56,520:INFO:   <<< temperature_new: 1.0
2024-11-09 08:46:56,520:INFO:   <<< text_num_hidden_layers: 12
2024-11-09 08:46:56,520:INFO:   <<< time_embedding: 0
2024-11-09 08:46:56,520:INFO:   <<< train_csv: data/.train.csv
2024-11-09 08:46:56,520:INFO:   <<< train_frame_order: 0
2024-11-09 08:46:56,520:INFO:   <<< use_mil: False
2024-11-09 08:46:56,520:INFO:   <<< val_csv: data/.val.csv
2024-11-09 08:46:56,520:INFO:   <<< video_dim: 1024
2024-11-09 08:46:56,520:INFO:   <<< visual_num_hidden_layers: 12
2024-11-09 08:46:56,520:INFO:   <<< warmup_proportion: 0.1
2024-11-09 08:46:56,520:INFO:   <<< world_size: 4
2024-11-09 08:46:56,558:INFO: device: cuda:2 n_gpu: 4
2024-11-09 08:46:56,571:INFO: device: cuda:3 n_gpu: 4
2024-11-09 08:46:56,585:INFO: device: cuda:1 n_gpu: 4
2024-11-09 08:46:56,684:INFO: device: cuda:0 n_gpu: 4
2024-11-09 08:46:59,184:INFO: loading archive file /home/zyl/flexible_k/modules/cross-base
2024-11-09 08:46:59,185:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-09 08:46:59,185:INFO: Weight doesn't exsits. /home/zyl/flexible_k/modules/cross-base/cross_pytorch_model.bin
2024-11-09 08:46:59,186:WARNING: Stage-One:True, Stage-Two:False
2024-11-09 08:46:59,186:WARNING: Test retrieval by loose type.
2024-11-09 08:46:59,186:WARNING: 	 embed_dim: 512
2024-11-09 08:46:59,186:WARNING: 	 image_resolution: 224
2024-11-09 08:46:59,186:WARNING: 	 vision_layers: 12
2024-11-09 08:46:59,186:WARNING: 	 vision_width: 768
2024-11-09 08:46:59,186:WARNING: 	 vision_patch_size: 32
2024-11-09 08:46:59,186:WARNING: 	 context_length: 77
2024-11-09 08:46:59,186:WARNING: 	 vocab_size: 49408
2024-11-09 08:46:59,186:WARNING: 	 transformer_width: 512
2024-11-09 08:46:59,186:WARNING: 	 transformer_heads: 8
2024-11-09 08:46:59,186:WARNING: 	 transformer_layers: 12
2024-11-09 08:46:59,186:WARNING: 		 linear_patch: 2d
2024-11-09 08:46:59,186:WARNING: 	 cut_top_layer: 0
2024-11-09 08:47:01,439:WARNING: 	 sim_header: meanP
2024-11-09 08:47:06,156:INFO: --------------------
2024-11-09 08:47:06,156:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-09 08:47:07,844:INFO: ***** Running test *****
2024-11-09 08:47:07,844:INFO:   Num examples = 1334
2024-11-09 08:47:07,844:INFO:   Batch size = 16
2024-11-09 08:47:07,845:INFO:   Num steps = 334
2024-11-09 08:47:07,845:INFO: ***** Running val *****
2024-11-09 08:47:07,845:INFO:   Num examples = 1334
2024-11-09 08:47:10,240:INFO: ***** Running training *****
2024-11-09 08:47:10,241:INFO:   Num examples = 5338
2024-11-09 08:47:10,241:INFO:   Batch size = 16
2024-11-09 08:47:10,241:INFO:   Num steps = 1998
2024-11-09 08:48:11,031:INFO: Effective parameters:
2024-11-09 08:48:11,031:INFO:   <<< K: 16
2024-11-09 08:48:11,031:INFO:   <<< adaptive_cls: 0
2024-11-09 08:48:11,032:INFO:   <<< aggregation: None
2024-11-09 08:48:11,032:INFO:   <<< alpha: 1.0
2024-11-09 08:48:11,032:INFO:   <<< batch_size: 16
2024-11-09 08:48:11,032:INFO:   <<< batch_size_val: 16
2024-11-09 08:48:11,032:INFO:   <<< cache_dir: 
2024-11-09 08:48:11,032:INFO:   <<< cluser_embed_from_clip: 1
2024-11-09 08:48:11,032:INFO:   <<< cluster_algo: kmediods++
2024-11-09 08:48:11,032:INFO:   <<< cluster_distance: euclidean
2024-11-09 08:48:11,032:INFO:   <<< cluster_embedding: 0
2024-11-09 08:48:11,032:INFO:   <<< cluster_frame_embedding: 0
2024-11-09 08:48:11,032:INFO:   <<< cluster_iter_limit: 100
2024-11-09 08:48:11,033:INFO:   <<< cluster_threshold: 1e-05
2024-11-09 08:48:11,033:INFO:   <<< coef_lr: 0.0001
2024-11-09 08:48:11,033:INFO:   <<< cross_model: cross-base
2024-11-09 08:48:11,033:INFO:   <<< cross_num_hidden_layers: 4
2024-11-09 08:48:11,033:INFO:   <<< data_path: /home/zyl/MeVTR_data_and_models/charades/annotation
2024-11-09 08:48:11,033:INFO:   <<< datatype: charades
2024-11-09 08:48:11,033:INFO:   <<< do_eval: False
2024-11-09 08:48:11,033:INFO:   <<< do_lower_case: False
2024-11-09 08:48:11,033:INFO:   <<< do_pretrain: False
2024-11-09 08:48:11,033:INFO:   <<< do_train: True
2024-11-09 08:48:11,033:INFO:   <<< dynamic_alpha: False
2024-11-09 08:48:11,033:INFO:   <<< epochs: 6
2024-11-09 08:48:11,033:INFO:   <<< eval_frame_order: 0
2024-11-09 08:48:11,033:INFO:   <<< expand_msrvtt_sentences: False
2024-11-09 08:48:11,034:INFO:   <<< feature_framerate: 1
2024-11-09 08:48:11,034:INFO:   <<< features_path: /home/zyl/MeVTR_data_and_models/charades/Charades_v2_3
2024-11-09 08:48:11,034:INFO:   <<< fp16: False
2024-11-09 08:48:11,034:INFO:   <<< fp16_opt_level: O1
2024-11-09 08:48:11,034:INFO:   <<< freeze_layer_num: 0
2024-11-09 08:48:11,034:INFO:   <<< global_info: False
2024-11-09 08:48:11,034:INFO:   <<< gradient_accumulation_steps: 1
2024-11-09 08:48:11,034:INFO:   <<< hard_negative_rate: 0.5
2024-11-09 08:48:11,034:INFO:   <<< init_model: None
2024-11-09 08:48:11,034:INFO:   <<< linear_patch: 2d
2024-11-09 08:48:11,034:INFO:   <<< local_rank: 0
2024-11-09 08:48:11,034:INFO:   <<< loose_type: True
2024-11-09 08:48:11,034:INFO:   <<< loss: balanced
2024-11-09 08:48:11,035:INFO:   <<< lr: 0.0001
2024-11-09 08:48:11,035:INFO:   <<< lr_decay: 0.9
2024-11-09 08:48:11,035:INFO:   <<< margin: 0.1
2024-11-09 08:48:11,035:INFO:   <<< max_frames: 64
2024-11-09 08:48:11,035:INFO:   <<< max_words: 77
2024-11-09 08:48:11,035:INFO:   <<< minkowski_norm_p: 2.0
2024-11-09 08:48:11,035:INFO:   <<< n_display: 100
2024-11-09 08:48:11,035:INFO:   <<< n_gpu: 1
2024-11-09 08:48:11,035:INFO:   <<< n_pair: 1
2024-11-09 08:48:11,035:INFO:   <<< negative_weighting: 1
2024-11-09 08:48:11,035:INFO:   <<< num_thread_reader: 2
2024-11-09 08:48:11,035:INFO:   <<< output_dir: /home/zyl/flexible_k/output_debug
2024-11-09 08:48:11,035:INFO:   <<< post_cluster_centroids: 16
2024-11-09 08:48:11,036:INFO:   <<< post_process: topk
2024-11-09 08:48:11,036:INFO:   <<< pre_norm: 0
2024-11-09 08:48:11,036:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-09 08:48:11,036:INFO:   <<< rank: 0
2024-11-09 08:48:11,036:INFO:   <<< regularize: none
2024-11-09 08:48:11,036:INFO:   <<< resume_model: None
2024-11-09 08:48:11,036:INFO:   <<< sampled_use_mil: False
2024-11-09 08:48:11,036:INFO:   <<< save_feature_path: None
2024-11-09 08:48:11,036:INFO:   <<< seed: 42
2024-11-09 08:48:11,036:INFO:   <<< shuffle_events: False
2024-11-09 08:48:11,036:INFO:   <<< shuffle_exp: False
2024-11-09 08:48:11,036:INFO:   <<< sim_header: meanP
2024-11-09 08:48:11,036:INFO:   <<< sim_lambda: 0.0
2024-11-09 08:48:11,037:INFO:   <<< slice_framepos: 2
2024-11-09 08:48:11,037:INFO:   <<< task_type: retrieval
2024-11-09 08:48:11,037:INFO:   <<< temperature_new: 1.0
2024-11-09 08:48:11,037:INFO:   <<< text_num_hidden_layers: 12
2024-11-09 08:48:11,037:INFO:   <<< time_embedding: 0
2024-11-09 08:48:11,037:INFO:   <<< train_csv: data/.train.csv
2024-11-09 08:48:11,037:INFO:   <<< train_frame_order: 0
2024-11-09 08:48:11,037:INFO:   <<< use_mil: False
2024-11-09 08:48:11,037:INFO:   <<< val_csv: data/.val.csv
2024-11-09 08:48:11,037:INFO:   <<< video_dim: 1024
2024-11-09 08:48:11,037:INFO:   <<< visual_num_hidden_layers: 12
2024-11-09 08:48:11,037:INFO:   <<< warmup_proportion: 0.1
2024-11-09 08:48:11,038:INFO:   <<< world_size: 4
2024-11-09 08:48:11,149:INFO: device: cuda:3 n_gpu: 4
2024-11-09 08:48:11,188:INFO: device: cuda:2 n_gpu: 4
2024-11-09 08:48:11,193:INFO: device: cuda:1 n_gpu: 4
2024-11-09 08:48:11,320:INFO: device: cuda:0 n_gpu: 4
2024-11-09 08:48:13,714:INFO: loading archive file /home/zyl/flexible_k/modules/cross-base
2024-11-09 08:48:13,714:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-09 08:48:13,715:INFO: Weight doesn't exsits. /home/zyl/flexible_k/modules/cross-base/cross_pytorch_model.bin
2024-11-09 08:48:13,715:WARNING: Stage-One:True, Stage-Two:False
2024-11-09 08:48:13,715:WARNING: Test retrieval by loose type.
2024-11-09 08:48:13,715:WARNING: 	 embed_dim: 512
2024-11-09 08:48:13,715:WARNING: 	 image_resolution: 224
2024-11-09 08:48:13,715:WARNING: 	 vision_layers: 12
2024-11-09 08:48:13,715:WARNING: 	 vision_width: 768
2024-11-09 08:48:13,715:WARNING: 	 vision_patch_size: 32
2024-11-09 08:48:13,715:WARNING: 	 context_length: 77
2024-11-09 08:48:13,715:WARNING: 	 vocab_size: 49408
2024-11-09 08:48:13,715:WARNING: 	 transformer_width: 512
2024-11-09 08:48:13,715:WARNING: 	 transformer_heads: 8
2024-11-09 08:48:13,715:WARNING: 	 transformer_layers: 12
2024-11-09 08:48:13,715:WARNING: 		 linear_patch: 2d
2024-11-09 08:48:13,715:WARNING: 	 cut_top_layer: 0
2024-11-09 08:48:15,996:WARNING: 	 sim_header: meanP
2024-11-09 08:48:20,766:INFO: --------------------
2024-11-09 08:48:20,767:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-09 08:48:22,764:INFO: ***** Running test *****
2024-11-09 08:48:22,764:INFO:   Num examples = 1334
2024-11-09 08:48:22,764:INFO:   Batch size = 16
2024-11-09 08:48:22,764:INFO:   Num steps = 334
2024-11-09 08:48:22,764:INFO: ***** Running val *****
2024-11-09 08:48:22,764:INFO:   Num examples = 1334
2024-11-09 08:48:26,356:INFO: ***** Running training *****
2024-11-09 08:48:26,356:INFO:   Num examples = 5338
2024-11-09 08:48:26,356:INFO:   Batch size = 16
2024-11-09 08:48:26,356:INFO:   Num steps = 1998
2024-11-09 08:57:39,946:INFO: Effective parameters:
2024-11-09 08:57:39,946:INFO:   <<< K: 16
2024-11-09 08:57:39,946:INFO:   <<< adaptive_cls: 0
2024-11-09 08:57:39,946:INFO:   <<< aggregation: None
2024-11-09 08:57:39,946:INFO:   <<< alpha: 1.0
2024-11-09 08:57:39,946:INFO:   <<< batch_size: 16
2024-11-09 08:57:39,946:INFO:   <<< batch_size_val: 16
2024-11-09 08:57:39,946:INFO:   <<< cache_dir: 
2024-11-09 08:57:39,946:INFO:   <<< cluser_embed_from_clip: 1
2024-11-09 08:57:39,946:INFO:   <<< cluster_algo: kmediods++
2024-11-09 08:57:39,946:INFO:   <<< cluster_distance: euclidean
2024-11-09 08:57:39,946:INFO:   <<< cluster_embedding: 0
2024-11-09 08:57:39,946:INFO:   <<< cluster_frame_embedding: 0
2024-11-09 08:57:39,946:INFO:   <<< cluster_iter_limit: 100
2024-11-09 08:57:39,946:INFO:   <<< cluster_threshold: 1e-05
2024-11-09 08:57:39,946:INFO:   <<< coef_lr: 0.0001
2024-11-09 08:57:39,946:INFO:   <<< cross_model: cross-base
2024-11-09 08:57:39,947:INFO:   <<< cross_num_hidden_layers: 4
2024-11-09 08:57:39,947:INFO:   <<< data_path: /home/zyl/MeVTR_data_and_models/charades/annotation
2024-11-09 08:57:39,947:INFO:   <<< datatype: charades
2024-11-09 08:57:39,947:INFO:   <<< do_eval: False
2024-11-09 08:57:39,947:INFO:   <<< do_lower_case: False
2024-11-09 08:57:39,947:INFO:   <<< do_pretrain: False
2024-11-09 08:57:39,947:INFO:   <<< do_train: True
2024-11-09 08:57:39,947:INFO:   <<< dynamic_alpha: False
2024-11-09 08:57:39,947:INFO:   <<< epochs: 6
2024-11-09 08:57:39,947:INFO:   <<< eval_frame_order: 0
2024-11-09 08:57:39,947:INFO:   <<< expand_msrvtt_sentences: False
2024-11-09 08:57:39,947:INFO:   <<< feature_framerate: 1
2024-11-09 08:57:39,947:INFO:   <<< features_path: /home/zyl/MeVTR_data_and_models/charades/Charades_v2_3
2024-11-09 08:57:39,947:INFO:   <<< fp16: False
2024-11-09 08:57:39,947:INFO:   <<< fp16_opt_level: O1
2024-11-09 08:57:39,947:INFO:   <<< freeze_layer_num: 0
2024-11-09 08:57:39,947:INFO:   <<< global_info: False
2024-11-09 08:57:39,947:INFO:   <<< gradient_accumulation_steps: 1
2024-11-09 08:57:39,947:INFO:   <<< hard_negative_rate: 0.5
2024-11-09 08:57:39,947:INFO:   <<< init_model: None
2024-11-09 08:57:39,947:INFO:   <<< linear_patch: 2d
2024-11-09 08:57:39,947:INFO:   <<< local_rank: 0
2024-11-09 08:57:39,947:INFO:   <<< loose_type: True
2024-11-09 08:57:39,947:INFO:   <<< loss: balanced
2024-11-09 08:57:39,947:INFO:   <<< lr: 0.0001
2024-11-09 08:57:39,947:INFO:   <<< lr_decay: 0.9
2024-11-09 08:57:39,947:INFO:   <<< margin: 0.1
2024-11-09 08:57:39,947:INFO:   <<< max_frames: 64
2024-11-09 08:57:39,948:INFO:   <<< max_words: 77
2024-11-09 08:57:39,948:INFO:   <<< minkowski_norm_p: 2.0
2024-11-09 08:57:39,948:INFO:   <<< n_display: 100
2024-11-09 08:57:39,948:INFO:   <<< n_gpu: 1
2024-11-09 08:57:39,948:INFO:   <<< n_pair: 1
2024-11-09 08:57:39,948:INFO:   <<< negative_weighting: 1
2024-11-09 08:57:39,948:INFO:   <<< num_thread_reader: 2
2024-11-09 08:57:39,948:INFO:   <<< output_dir: /home/zyl/flexible_k/output_debug
2024-11-09 08:57:39,948:INFO:   <<< post_cluster_centroids: 16
2024-11-09 08:57:39,948:INFO:   <<< post_process: topk
2024-11-09 08:57:39,948:INFO:   <<< pre_norm: 0
2024-11-09 08:57:39,948:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-09 08:57:39,948:INFO:   <<< rank: 0
2024-11-09 08:57:39,948:INFO:   <<< regularize: none
2024-11-09 08:57:39,948:INFO:   <<< resume_model: None
2024-11-09 08:57:39,948:INFO:   <<< sampled_use_mil: False
2024-11-09 08:57:39,948:INFO:   <<< save_feature_path: None
2024-11-09 08:57:39,948:INFO:   <<< seed: 42
2024-11-09 08:57:39,948:INFO:   <<< shuffle_events: False
2024-11-09 08:57:39,948:INFO:   <<< shuffle_exp: False
2024-11-09 08:57:39,948:INFO:   <<< sim_header: meanP
2024-11-09 08:57:39,948:INFO:   <<< sim_lambda: 0.0
2024-11-09 08:57:39,948:INFO:   <<< slice_framepos: 2
2024-11-09 08:57:39,948:INFO:   <<< task_type: retrieval
2024-11-09 08:57:39,948:INFO:   <<< temperature_new: 1.0
2024-11-09 08:57:39,948:INFO:   <<< text_num_hidden_layers: 12
2024-11-09 08:57:39,948:INFO:   <<< time_embedding: 0
2024-11-09 08:57:39,948:INFO:   <<< train_csv: data/.train.csv
2024-11-09 08:57:39,948:INFO:   <<< train_frame_order: 0
2024-11-09 08:57:39,948:INFO:   <<< use_mil: False
2024-11-09 08:57:39,949:INFO:   <<< val_csv: data/.val.csv
2024-11-09 08:57:39,949:INFO:   <<< video_dim: 1024
2024-11-09 08:57:39,949:INFO:   <<< visual_num_hidden_layers: 12
2024-11-09 08:57:39,949:INFO:   <<< warmup_proportion: 0.1
2024-11-09 08:57:39,949:INFO:   <<< world_size: 4
2024-11-09 08:57:40,061:INFO: device: cuda:3 n_gpu: 4
2024-11-09 08:57:40,068:INFO: device: cuda:0 n_gpu: 4
2024-11-09 08:57:40,070:INFO: device: cuda:1 n_gpu: 4
2024-11-09 08:57:40,072:INFO: device: cuda:2 n_gpu: 4
2024-11-09 08:57:42,487:INFO: loading archive file /home/zyl/flexible_k/modules/cross-base
2024-11-09 08:57:42,488:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-09 08:57:42,488:INFO: Weight doesn't exsits. /home/zyl/flexible_k/modules/cross-base/cross_pytorch_model.bin
2024-11-09 08:57:42,488:WARNING: Stage-One:True, Stage-Two:False
2024-11-09 08:57:42,489:WARNING: Test retrieval by loose type.
2024-11-09 08:57:42,489:WARNING: 	 embed_dim: 512
2024-11-09 08:57:42,489:WARNING: 	 image_resolution: 224
2024-11-09 08:57:42,489:WARNING: 	 vision_layers: 12
2024-11-09 08:57:42,489:WARNING: 	 vision_width: 768
2024-11-09 08:57:42,489:WARNING: 	 vision_patch_size: 32
2024-11-09 08:57:42,489:WARNING: 	 context_length: 77
2024-11-09 08:57:42,489:WARNING: 	 vocab_size: 49408
2024-11-09 08:57:42,489:WARNING: 	 transformer_width: 512
2024-11-09 08:57:42,489:WARNING: 	 transformer_heads: 8
2024-11-09 08:57:42,489:WARNING: 	 transformer_layers: 12
2024-11-09 08:57:42,489:WARNING: 		 linear_patch: 2d
2024-11-09 08:57:42,489:WARNING: 	 cut_top_layer: 0
2024-11-09 08:57:44,790:WARNING: 	 sim_header: meanP
2024-11-09 08:57:49,629:INFO: --------------------
2024-11-09 08:57:49,629:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-09 08:57:51,064:INFO: ***** Running test *****
2024-11-09 08:57:51,064:INFO:   Num examples = 1334
2024-11-09 08:57:51,064:INFO:   Batch size = 16
2024-11-09 08:57:51,064:INFO:   Num steps = 334
2024-11-09 08:57:51,064:INFO: ***** Running val *****
2024-11-09 08:57:51,064:INFO:   Num examples = 1334
2024-11-09 08:57:53,671:INFO: ***** Running training *****
2024-11-09 08:57:53,671:INFO:   Num examples = 5338
2024-11-09 08:57:53,671:INFO:   Batch size = 16
2024-11-09 08:57:53,671:INFO:   Num steps = 1998
